#!/bin/bash
set -e

# Dosya izinlerini ayarla
if [ -f "/opt/HacPasaport/install.sh" ]; then
    chmod +x /opt/HacPasaport/install.sh
fi
if [ -f "/opt/HacPasaport/source/HacPasaport/pasaport.sh" ]; then
    chmod +x /opt/HacPasaport/source/HacPasaport/pasaport.sh
fi
if [ -f "/opt/HacPasaport/source/HacPasaport/sc.sh" ]; then
    chmod +x /opt/HacPasaport/source/HacPasaport/sc.sh
fi

# OpenCV jar arşivini çıkar
if [ -f "/opt/HacPasaport/source/HacPasaport/opencv-3.4.2-0.jar.tar.gz" ]; then
    cd /opt/HacPasaport/source/HacPasaport/
    tar -xzf opencv-3.4.2-0.jar.tar.gz
    rm -f opencv-3.4.2-0.jar.tar.gz
fi

# Desktop dosyası izinlerini ayarla
if [ -f "/usr/share/applications/hac-pasaport-kurulum.desktop" ]; then
    chmod 644 /usr/share/applications/hac-pasaport-kurulum.desktop
fi

# update-desktop-database çalıştır
if command -v update-desktop-database >/dev/null 2>&1; then
    update-desktop-database /usr/share/applications
fi

echo "HacPasaport Kurulum paketi başarıyla kuruldu!"
echo "Uygulamalar menüsünden 'Pasaport Tarayıcı Kurulum' uygulamasını çalıştırabilirsiniz." 